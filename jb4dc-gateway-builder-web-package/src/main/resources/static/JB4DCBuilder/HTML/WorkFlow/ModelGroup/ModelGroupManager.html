<!DOCTYPE html><html lang="zh" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"><head><meta charset="UTF-8"><title>模型分组管理1</title><title>JBuild4D</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><script type="text/javascript" src="../../../../Js/External/JQuery-3.6.0/jquery-3.6.0.min.js"></script><script type="text/javascript" src="../../../../Js/External/VUE-2.6.10/vue.js"></script><script type="text/javascript" src="../../../../Js/External/IView-4.X/dist/iview.min.js"></script><script type="text/javascript" src="../../../../Js/External/JQuery-UI-1.13.0/jquery-ui.js"></script><script type="text/javascript" src="../../../../Js/External/ZTree-3.5.40/js/jquery.ztree.all.js"></script><script type="text/javascript" src="../../../../Js/External/Perfect-Scrollbar-V1.4.0/perfect-scrollbar.js"></script><script type="text/javascript" src="../../../../Js/JBuild4DCLib.js?refVersion=1650644464560"></script><script type="text/javascript" src="../../../../Js/UIEXComponent.js?refVersion=1650644464560"></script><script type="text/javascript" src="../../../../Js/VueEXComponent.js?refVersion=1650644464560"></script><script type="text/javascript" src="../../../../JB4DCBuilder/Js/UIEXComponentForBuilder.js?refVersion=1650644464560"></script><script type="text/javascript" src="../../../../JB4DCBuilder/Js/BuilderVueEXComponent.js?refVersion=1650644464560"></script><script type="text/javascript" src="../../../../SSOSystem/Js/SSOVueEXComponent.js?refVersion=1650644464560"></script><link rel="stylesheet" type="text/css" href="../../../../Themes/Default/IView-4.X/iview.css"><link rel="stylesheet" type="text/css" href="../../../../Themes/Default/JQueryUI/jquery-ui.css"><link rel="stylesheet" type="text/css" href="../../../../Themes/Default/JQueryUI/jquery-ui-important.css"><link rel="stylesheet" type="text/css" href="../../../../Js/External/Perfect-Scrollbar-V1.4.0/perfect-scrollbar.css"><link rel="stylesheet" type="text/css" href="../../../../Themes/Default/ZTree/zTreeStyle/zTreeStyle.css"><link rel="stylesheet" type="text/css" href="../../../../Themes/Default/Css/JBuild4DC.css?refVersion=1650644464560"><link rel="stylesheet" type="text/css" href="../../../../JB4DCBuilder/Themes/Default/Css/JBuild4DCBuilder.css?refVersion=1650644464560"><script type="text/javascript" src="../../../../Js/External/Go-2.1.18/go-debug.js"></script><script type="text/javascript" src="../../../../Js/External/Go-2.1.18/Figures.js"></script></head><body><div id="appList" class="iv-list-page-wrap"><div class="list-button-outer-wrap" id="list-button-wrap"><div class="list-button-inner-wrap" style="margin-bottom:10px"><button-group><i-button type="success" @click="add()" icon="md-add">新增</i-button><i-button type="primary" @click="edit()" icon="md-create">修改</i-button><i-button type="primary" @click="del()" icon="md-close">删除</i-button><i-button type="primary" @click="view()" icon="md-search">浏览</i-button><i-button type="primary" @click="statusEnable('启用')" icon="md-checkmark-circle">启用</i-button><i-button type="primary" @click="statusEnable('禁用')" icon="md-close-circle">禁用</i-button><i-button type="primary" @click="move('up')" icon="md-arrow-up">上移</i-button><i-button type="primary" @click="move('down')" icon="md-arrow-down">下移</i-button></button-group></div><div style="clear:both"></div></div><div id="divTreeTable" style="width:100%;margin:auto;overflow:auto"></div></div><script>var treeTableObj=null,appList=new Vue({el:"#appList",mounted:function(){this.reloadTreeTableData(),window.setTimeout(function(){$("#divTreeTable").css("height",ListPageUtility.GetGeneralPageHeight(-20))},500)},data:{acInterface:{editView:"/HTML/WorkFlow/ModelGroup/ModelGroupEdit.html",reloadData:"/Rest/WorkFlow/Model/ModelGroup/GetTreeData",delete:"/HTML/WorkFlow/ModelGroup/Delete",statusChange:"/HTML/WorkFlow/ModelGroup/StatusChange",move:"/HTML/WorkFlow/ModelGroup/Move"},treeTableObject:null,treeTableConfig:{CanDeleteWhenHasChild:!1,IdField:"modelGroupId",RowIdPrefix:"TreeTable_",LoadChildJsonURL:"",LoadChildFunc:null,OpenLevel:1,ChildTestField:"modelGroupChildCount",Templates:[{Title:"分组名称",FieldName:"modelGroupText",TitleCellClassName:"TitleCell",Hidden:!1,TitleCellAttrs:{},Width:"40"},{Title:"分组值",FieldName:"modelGroupValue",TitleCellClassName:"TitleCell",Hidden:!1,TitleCellAttrs:{},Width:"40",TextAlign:"center"},{Title:"创建时间",FieldName:"modelGroupCreateTime",TitleCellClassName:"TitleCell",Renderer:"DateTime",Hidden:!1,TitleCellAttrs:{},Width:"40",TextAlign:"center"},{Title:"备注",FieldName:"modelGroupDesc",TitleCellClassName:"TitleCell",Hidden:!1,TitleCellAttrs:{},Width:"10%",TextAlign:"center"}],TableClass:"TreeTable",RendererTo:"divTreeTable",TableId:"TreeTable",TableAttrs:{cellpadding:"0",cellspacing:"0",border:"0"}}},methods:{reloadTreeTableData:function(){AjaxUtility.Post(this.acInterface.reloadData,{},function(e){if(e.success){null==e.data&&(e.data=new Array);var t=JsonUtility.ParseArrayJsonToTreeJson({KeyField:"modelGroupId",RelationField:"modelGroupParentId",ChildFieldName:"Nodes"},e.data,"0");$("#divTreeTable").html(""),this.treeTableObject=Object.create(TreeTable),this.treeTableObject.Initialization(this.treeTableConfig),this.treeTableObject.LoadJsonData(t)}else DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},e.message,null)},this)},mareSureSelectedTreeTableRow:function(e){var t=this.treeTableObject.GetSelectedRowData();return null==t?(DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"请选择需要"+e+"的节点!",null),{then:function(e){}}):"0"==t[appList.treeTableConfig.IdField]?(DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"不能编辑根节点!",null),{then:function(e){}}):{then:function(e){e.call(appList,t)}}},add:function(){if(null!=this.treeTableObject){var e=this.treeTableObject.GetSelectedRowData();if(null==e)return DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},"请选择上级分组!",null),!1;var t=BaseUtility.BuildView(this.acInterface.editView,{parentId:e[this.treeTableConfig.IdField],op:"add"});DialogUtility.Frame_OpenIframeWindow(window,DialogUtility.DialogId,t,{title:"流程模型分组"},1)}},edit:function(){this.mareSureSelectedTreeTableRow("编辑").then(function(e){var t=BaseUtility.BuildView(this.acInterface.editView,{op:"update",recordId:e[this.treeTableConfig.IdField]});DialogUtility.Frame_OpenIframeWindow(window,DialogUtility.DialogId,t,{title:"组织管理"},1)})},del:function(){this.mareSureSelectedTreeTableRow("删除").then(function(e){var t=e[this.treeTableConfig.IdField],i=this;DialogUtility.Confirm(window,"确认要删除选定的节点吗？",function(){AjaxUtility.Delete(i.acInterface.delete,{recordId:t},function(e){e.success?DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},e.message,function(){this.treeTableObject.DeleteRow(t)},this):DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},e.message,null)},this)},this)})},view:function(){this.mareSureSelectedTreeTableRow("编辑").then(function(e){var t=BaseUtility.BuildView(this.acInterface.editView,{op:"view",recordId:e[this.treeTableConfig.IdField]});DialogUtility.Frame_OpenIframeWindow(window,DialogUtility.DialogId,t,{title:"组织管理"},1)})},statusEnable:function(i){this.mareSureSelectedTreeTableRow("启用").then(function(t){var e=t[appList.treeTableConfig.IdField];AjaxUtility.Post(this.acInterface.statusChange,{ids:e,status:i},function(e){e.success?DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},e.message,function(){t.organStatus=i,this.treeTableObject.UpdateToRow(t[appList.treeTableConfig.IdField],t)},this):DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},e.message,null)},this)})},move:function(i){this.mareSureSelectedTreeTableRow("选中").then(function(t){var e=t[appList.treeTableConfig.IdField];AjaxUtility.Post(this.acInterface.move,{recordId:e,type:i},function(e){e.success?DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},e.message,function(){"down"==i?this.treeTableObject.MoveDownRow(t[appList.treeTableConfig.IdField]):this.treeTableObject.MoveUpRow(t[appList.treeTableConfig.IdField])},this):DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},e.message,null)},this)})},newTreeTableNode:function(e){this.treeTableObject.AppendChildRowToCurrentSelectedRow(e)},updateTreeTableNode:function(e){this.treeTableObject.UpdateToRow(e[appList.treeTableConfig.IdField],e)},reloadOrganData:function(t){AjaxUtility.Post(this.acInterface.reloadData,{pageSize:2e3,pageNum:1},function(e){e.success?t(e):DialogUtility.Alert(window,DialogUtility.DialogAlertId,{},e.message,null)},this)}}})</script></body></html>