<!DOCTYPE html>
<html lang="zh" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <th:block th:replace="Fragment/GeneralLib::GeneralLib"></th:block>
    <th:block th:replace="Fragment/GeneralLib::JBuild4DFormDesignLib"></th:block>
    <th:block th:replace="Fragment/GeneralLib::ThemesLib"></th:block>
</head>
<body>
    <div class="html-design-plugin-dialog-wraper" id="dialogApp" v-cloak>
        <tabs size="small">
            <tab-pane label="绑定信息">
                <fd-control-bind-to :bind-to-field-prop="bindToField" :default-value-prop="defaultValue" :validate-rules-prop="validateRules" @on-set-completed="setBindCompleted">
                </fd-control-bind-to>
            </tab-pane>
            <tab-pane label="标签设置">
                <table cellpadding="0" cellspacing="0" border="0" class="html-design-plugin-dialog-table-wraper">
                    <colgroup>
                        <col style="width: 120px" />
                        <col />
                    </colgroup>
                    <tbody>
                        <tr>
                            <td>
                                格式化：
                            </td>
                            <td>
                                <select  v-model="normalProps.defFormat">
                                    <option value="notFormat">无</option>
                                    <option value="yyyy-MM-dd">yyyy-MM-dd</option>
                                    <option value="yyyy-MM-dd HH:mm:ss">yyyy-MM-dd HH:mm:ss</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                客户端渲染方法：
                            </td>
                            <td>
                                <i-input v-model="normalProps.custClientRendererMethod" placeholder="客户端渲染方法,按钮将经由该方法渲染,最终形成页面元素,需要返回最终元素的HTML对象" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                参数：
                            </td>
                            <td>
                                <i-input v-model="normalProps.custClientRendererMethodPara" placeholder="客户端渲染方法的参数" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                触发按钮：
                            </td>
                            <td>
                                <radio-group type="button" style="margin: auto" v-model="normalProps.targetButtonId">
                                    <radio label="empty">无</radio>
                                    <radio label="update">修改</radio>
                                    <radio label="view">查看</radio>
                                </radio-group>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                点击调用方法：
                            </td>
                            <td>
                                <i-input v-model="normalProps.custClickEvent" placeholder="客户端点击调用方法" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                参数：
                            </td>
                            <td>
                                <i-input v-model="normalProps.custClickEventPara" placeholder="客户端点击调用方法的参数" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                序号生成：
                            </td>
                            <td>
                                <radio-group type="button" style="margin: auto" v-model="normalProps.sequenceNumber">
                                    <radio label="true">是</radio>
                                    <radio label="false">否</radio>
                                </radio-group>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </tab-pane>
            <tab-pane label="基础信息">
                <fd-control-base-info v-model="baseInfo">
                </fd-control-base-info>
            </tab-pane>
        </tabs>
    </div>
    <script>
        var DialogApp=new Vue({
            el:"#dialogApp",
            data: {
                baseInfo:CKEditorPluginUtility.DefaultProps.baseInfo,
                bindToField:CKEditorPluginUtility.DefaultProps.bindToField,
                defaultValue: CKEditorPluginUtility.DefaultProps.defaultValue,
                validateRules:CKEditorPluginUtility.DefaultProps.validateRules,
                normalProps:{
                    sequenceNumber:"false",
                    custClickEvent:"",
                    custClickEventPara:"",
                    targetButtonId:"empty",
                    custClientRendererMethod:"",
                    custClientRendererMethodPara:"",
                    defFormat:"notFormat"
                }
            },
            mounted:function () {

            },
            methods: {
                ready:function(actionName){
                    this.baseInfo.id="lab_"+StringUtility.Timestamp();
                    this.baseInfo.name=this.baseInfo.id;
                },
                setBindCompleted:function(bindToField,defaultValue,validateRules){
                    this.bindToField=bindToField;
                    this.defaultValue=defaultValue;
                    this.validateRules=validateRules;
                },
                getControlProps:function () {
                    var result = {
                        success: true,
                        baseInfo: this.baseInfo,
                        bindToField: this.bindToField,
                        defaultValue: this.defaultValue,
                        validateRules: this.validateRules,
                        normalProps: this.normalProps
                    }
                    return CKEditorPluginUtility.ValidateSerializeControlDialogCompletedEnable(result);
                },
                setControlProps:function ($elem,props) {
                    this.baseInfo = props.baseInfo ? props.baseInfo : this.baseInfo;
                    this.bindToField = props.bindToField ? props.bindToField : this.bindToField;
                    this.defaultValue = props.defaultValue ? props.defaultValue : this.defaultValue;
                    this.validateRules = props.validateRules ? props.validateRules : this.validateRules;

                    this.normalProps.sequenceNumber = $elem.attr("sequenceNumber");
                    if(!this.normalProps.sequenceNumber){
                        this.normalProps.sequenceNumber="false";
                    }
                    this.normalProps.custClickEvent = $elem.attr("custclickevent");
                    this.normalProps.custClickEventPara = $elem.attr("custclickeventpara");
                    this.normalProps.targetButtonId = $elem.attr("targetbuttonid");
                    if(!this.normalProps.targetButtonId){
                        this.normalProps.targetButtonId="empty";
                    }
                    this.normalProps.custClientRendererMethod = $elem.attr("custclientrenderermethod");
                    this.normalProps.custClientRendererMethodPara = $elem.attr("custclientrenderermethodpara");
                    this.normalProps.defFormat = $elem.attr("defformat");
                }
            }
        });
    </script>
</body>
</html>